@model IEnumerable<WebClientToService.Models.WebAuction>

@{
    ViewBag.Title = "Auctions";
}
<body oncontextmenu="return false">
    <script>
        document.onkeydown = function (e) {
            if (event.keyCode == 123) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
                return false;
            }
        }
    </script>
    <table class="table">
        <tr>

            <th>
                @Html.DisplayNameFor(model => model.ProductName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ProductDescription)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.TimeLeft)
            </th>

            <th></th>
        </tr>

        @if (Model != null)
        {
            foreach (var item in Model)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.ProductName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ProductDescription)
                    </td>

                    <td class="timeLeft">
                        @Html.DisplayFor(modelItem => item.TimeLeft)

                    </td>

                    <td>
                        @Html.ActionLink("Bid", "List", "Bid", new { id = item.AuctionId }, null) |
                    </td>

                </tr>
                @*<td>
                        @Html.ActionLink("Edit", "Edit", new { id = item.PersonId }) |
                        @Html.ActionLink("Details", "Details", new { id = item.PersonId }) |
                        @Html.ActionLink("Delete", "Delete", new { id = item.PersonId })
                    </td>*@

            }
        }
        else
        {
            <tr>
                <td colspan="5">No data retrieved!</td>
            </tr>
        }

    </table>
</body>



<script>
    // Set the date we're counting down to



    var x = setInterval(function () {
        var AllElements = document.getElementsByClassName("timeLeft");
        for (var i = 0; i < AllElements.length; i++)
        {
            var countDownDate = new Date(AllElements[i].innerHTML);
            

            // Get today's date and time
            var now = new Date().getTime();

            // Find the distance between now and the count down date
            var distance = countDownDate - now;

            // Time calculations for days, hours, minutes and seconds
            var days = Math.floor(distance / (1000 * 60 * 60 * 24));
            var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Output the result in an element with id="demo"
            AllElements[i].innerHTML = days + "d " + hours + "h "
                + minutes + "m " + seconds + "s ";
            console.log(AllElements);
            // If the count down is over, write some text
            if (distance < 0)
            {
                clearInterval(x);
                AllElements[i].innerHTML = "AUCTION EXPIRED";
            }
        };
    }, 1000);
    



    //var countDownDate = new Date(document.getElementsByClassName("timeLeft").innerHTML);
    //for (var i = 0; i < countDownDate.lenght; i++) {
    //    // Update the count down every 1 second
    //    var x = setInterval(function () {

    //        // Get today's date and time
    //        var now = new Date().getTime();

    //        // Find the distance between now and the count down date
    //        var distance = countDownDate - now;

    //        // Time calculations for days, hours, minutes and seconds
    //        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
    //        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    //        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    //        var seconds = Math.floor((distance % (1000 * 60)) / 1000);

    //        // Output the result in an element with id="demo"
    //        document.getElementsByClassName("timeLeft").innerHTML = days + "d " + hours + "h "
    //            + minutes + "m " + seconds + "s ";

    //        // If the count down is over, write some text
    //        if (distance < 0) {
    //            clearInterval(x);
    //            document.getElementsByClassName("timeLeft").innerHTML = "AUCTION EXPIRED";
    //        }
    //    }, 1000);
    //}




</script>




@*<html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <title>Auctions</title>
    </head>
    <body>
        <h3>@Model.Count auctions</h3>
        <div>
            <ul>
                @{
                    foreach (var item in Model) {
                        <li>@item</li>
                    }
                }
            </ul>

        </div>
    </body>
    </html>*@
